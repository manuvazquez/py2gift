---

title: Core

keywords: fastai
sidebar: home_sidebar

summary: "Main functionality."
description: "Main functionality."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/manu/py2gift/gift_wrapper/core.py:7: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
  from tqdm.autonotebook import tqdm
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The implementation of the main script is actually in the <a href="/py2gift/core#build"><code>build</code></a> function below. <a href="/py2gift/core#main"><code>main</code></a> is just a <em>wrapper</em> that parses command-line arguments.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Command-line-arguments">Command-line arguments<a class="anchor-link" href="#Command-line-arguments"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The function below just parses command-line arguments and pass them to the <a href="/py2gift/core#build"><code>build</code></a> function below.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="main" class="doc_header"><code>main</code><a href="https://github.com/manuvazquez/py2gift/tree/master/py2gift/core.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>main</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Auxiliary-functions">Auxiliary functions<a class="anchor-link" href="#Auxiliary-functions"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Obtaining-the-__init__-parameters-for-a-class-from-the-corresponding-settings">Obtaining the <code>__init__</code> parameters for a class from the corresponding settings<a class="anchor-link" href="#Obtaining-the-__init__-parameters-for-a-class-from-the-corresponding-settings"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A function to obtain the initialization parameters of a given class given the corresponding settings.</p>
<ul>
<li><code>cls_settings</code>: a <code>dict</code> with the all parameters for the class; it should include keys <code>statement</code>, <code>feedback</code> and, optionally, <code>time</code></li>
</ul>
<p>It returns another dictionary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="init_parameters_from_settings" class="doc_header"><code>init_parameters_from_settings</code><a href="https://github.com/manuvazquez/py2gift/tree/master/py2gift/core.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>init_parameters_from_settings</code>(<strong><code>cls_settings</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Returns a dictionary with the initialization parameters for a question.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>cls_settings: dict
    Settings for the class, which should include <code>statement</code>, <code>feedback</code> and, optionally, <a href="/py2gift/time"><code>time</code></a>.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>out: dict
    A dictionary with the <em>exact</em> parameters that must be passed when instantiating the class.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The name for a <em>testing</em> file</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;_input.yaml&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%writefile</span> {input_file}

<span class="n">output</span> <span class="n">file</span><span class="p">:</span> <span class="n">quiz</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">pictures</span> <span class="n">base</span> <span class="n">directory</span><span class="p">:</span> <span class="n">tc</span><span class="o">/</span><span class="n">midterm3</span>

<span class="n">categories</span><span class="p">:</span>

  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Test</span> <span class="n">category</span>

    <span class="n">classes</span><span class="p">:</span>

      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">TestClass</span>

        <span class="n">question</span> <span class="n">base</span> <span class="n">name</span><span class="p">:</span> <span class="n">Test</span> <span class="k">class</span>
            
        <span class="nc">init</span> <span class="n">parameters</span><span class="p">:</span>
            
            <span class="n">distribution</span><span class="p">:</span> <span class="n">Gaussian</span>

        <span class="n">statement</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">Consider</span> <span class="n">a</span> <span class="n">random</span> <span class="n">variable</span><span class="p">,</span> <span class="err">$</span><span class="n">X</span><span class="err">$</span><span class="p">,</span> <span class="k">with</span> <span class="n">mean</span> <span class="err">$</span> \<span class="n">mu</span> <span class="o">=</span> <span class="err">!</span><span class="n">mean</span> <span class="err">$</span> <span class="ow">and</span> <span class="n">variance</span><span class="o">...</span>
          

        <span class="n">feedback</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">Clearly</span><span class="p">,</span> <span class="err">$</span><span class="n">Y</span><span class="err">$</span> <span class="ow">is</span><span class="o">...</span>
          

        <span class="n">time</span><span class="p">:</span> <span class="mi">15</span>
        
        <span class="n">number</span> <span class="n">of</span> <span class="n">instances</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <em>initialization parameters</em> for the first class in the first category can be obtained as</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_data</span> <span class="o">=</span> <span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">yaml_to_dict</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>    
<span class="n">init_parameters_from_settings</span><span class="p">(</span><span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;classes&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If <code>init_parameters</code> is absent, then no parameters will be passed when instatiating the class.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Processing-of-a-bunch-of-questions">Processing of a bunch of questions<a class="anchor-link" href="#Processing-of-a-bunch-of-questions"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-a-GIFT-file-from-generators'-settings">Building a <em>GIFT</em> file from generators' settings<a class="anchor-link" href="#Building-a-GIFT-file-from-generators'-settings"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The workhorse of the library.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build" class="doc_header"><code>build</code><a href="https://github.com/manuvazquez/py2gift/tree/master/py2gift/core.py#L89" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build</code>(<strong><code>settings</code></strong>:<code>Union</code>[<code>str</code>, <code>dict</code>], <strong><code>local_run</code></strong>:<code>bool</code>, <strong><code>questions_module</code></strong>:<code>module</code>, <strong><code>parameters_file</code></strong>:<code>Union</code>[<code>str</code>, <code>dict</code>]=<em><code>'parameters.yaml'</code></em>, <strong><code>no_checks</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>overwrite_existing_latex_files</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>embed_images</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Generates a GIFT file.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>settings: str or dict
    Settings for all the questions (generators).
local_run: bool
    If True, pictures will not be copied to a remote host.
questions_module: ModuleType
    A module or structure that holds the classes referenced in the settings.
parameters_file: str or dict
    File or dictionary with the parameters for "gift-wrapper".
no_checks: bool
    Whether or not LaTeX formulas should be checked.
overwrite_existing_latex_files: bool
    If True the auxiliar file for checks should be, if existing, overwritten without a warning.
embed_images: bool
    If True, images will be embedded in the questions (rather than linked).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function expects, among other things, an <em>input file</em> (defined above), a <em>module</em> implementing the classes referenced in the latter, and a <em>parameters file</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-with-questions">Module with questions<a class="anchor-link" href="#Module-with-questions"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This can be used in the same way as module would.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FakeModule</span><span class="p">:</span>
    
    <span class="k">class</span> <span class="nc">TestClass</span><span class="p">(</span><span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">NumericalQuestionGenerator</span><span class="p">):</span>
    
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">statement</span><span class="p">:</span> <span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">TemplatedLatexText</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">TemplatedLatexText</span><span class="p">,</span>
            <span class="n">distribution</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">prng</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="n">feedback</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">prng</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span>
        
        <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            
            <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">statement</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="mi">42</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;10%&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parameters-file">Parameters file<a class="anchor-link" href="#Parameters-file"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parameters_file</span> <span class="o">=</span> <span class="s1">&#39;_parameters.yaml&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%writefile</span> {parameters_file}
<span class="n">images</span> <span class="n">hosting</span><span class="p">:</span>

  <span class="n">ssh</span><span class="p">:</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">mvazquez</span>

    <span class="c1"># below, one should specify either a password for the user or  &quot;public key&quot; file but NOT both of them</span>

    <span class="n">password</span><span class="p">:</span>

    <span class="c1"># &quot;~&quot; stands for the user&#39;s home directory (in Linux for one...)</span>
    <span class="n">public_key</span><span class="p">:</span> <span class="o">~/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa_mymachine</span><span class="o">.</span><span class="n">pub</span>

  <span class="n">copy</span><span class="p">:</span>
    <span class="c1"># machine into which files will be copied</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">hidra1</span>

    <span class="c1"># the path that in the remote machine acts as root of the publicly visible directories hierarchy (hence it&#39;s not</span>
    <span class="c1"># visible from outside);  it *should* exist (&quot;.&quot; stands for the working directory when you ssh into the machine)</span>
    <span class="n">public</span> <span class="n">filesystem</span> <span class="n">root</span><span class="p">:</span> <span class="o">./</span><span class="n">public_html</span>

  <span class="c1"># public address from which the images will hang</span>
  <span class="n">public</span> <span class="n">URL</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tsc</span><span class="o">.</span><span class="n">uc3m</span><span class="o">.</span><span class="n">es</span><span class="o">/~</span><span class="n">mvazquez</span><span class="o">/</span>

<span class="n">latex</span><span class="p">:</span>

  <span class="c1"># auxiliary TeX file that will be created to check that formulas can be compiled</span>
  <span class="n">auxiliary</span> <span class="n">file</span><span class="p">:</span> <span class="n">__latex_check</span><span class="o">.</span><span class="n">tex</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">build</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">local_run</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">questions_module</span><span class="o">=</span><span class="n">FakeModule</span><span class="p">,</span> <span class="n">parameters_file</span><span class="o">=</span><span class="n">parameters_file</span><span class="p">,</span> <span class="n">no_checks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The file actually created underneath by <a href="/py2gift/core#build"><code>build</code></a> (the name, <em>quiz.yaml</em>, was set above in the <code>input_file</code>)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pycat</span> quiz.yaml
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>is ultimately processed by <code>gift_wrapper</code> to yield</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">cat</span> quiz.gift.txt
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the file that is actually imported from <em>Moodle</em>, and <em>quiz.yaml</em> is mostly a <em>side effect</em>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>rm quiz.yaml quiz.gift.txt
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One can also pass directly the <code>dict</code> with the settings.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">settings</span> <span class="o">=</span> <span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">yaml_to_dict</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>

<span class="n">build</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">local_run</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">questions_module</span><span class="o">=</span><span class="n">FakeModule</span><span class="p">,</span> <span class="n">parameters_file</span><span class="o">=</span><span class="n">parameters_file</span><span class="p">,</span> <span class="n">no_checks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pycat</span> quiz.yaml
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Processing-a-single-question">Processing a single question<a class="anchor-link" href="#Processing-a-single-question"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is mostly intended for previewing a question in a <a href="https://jupyter.org/">jupyter</a> notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-a-single-question">Building a single question<a class="anchor-link" href="#Building-a-single-question"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function returns settings that allow building a question using <em>gift-wrapper</em>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_question" class="doc_header"><code>build_question</code><a href="https://github.com/manuvazquez/py2gift/tree/master/py2gift/core.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_question</code>(<strong><code>question_generator</code></strong>:<a href="/py2gift/question#QuestionGenerator"><code>QuestionGenerator</code></a>, <strong><code>category_name</code></strong>:<code>str</code>, <strong><code>settings</code></strong>:<code>dict</code>, <strong><code>n_question</code></strong>:<code>int</code>=<em><code>0</code></em>)</p>
</blockquote>
<p>Returns the settings for building a question using "gift-wrapper".</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>question_generator: class
    The question generator that will generate the appropirate settings.
category_name: str
    The name of category the class belongs to.
settings: dict
    User settings.
n_question: int
    The number of instance to be returned.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>out: dict
    A dictionary with the settings that allow building the question using "gift-wrapper".</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For testing, we need some settings. It is more natural to read and write them in a file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">settings_file</span> <span class="o">=</span> <span class="s1">&#39;_settings.yaml&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%writefile</span> {settings_file}

<span class="n">output</span> <span class="n">file</span><span class="p">:</span> <span class="n">quiz</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">pictures</span> <span class="n">base</span> <span class="n">directory</span><span class="p">:</span> <span class="n">pics</span>

<span class="n">categories</span><span class="p">:</span>

  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Category</span> <span class="mi">1</span>

    <span class="n">classes</span><span class="p">:</span>

      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">A</span>

        <span class="n">question</span> <span class="n">base</span> <span class="n">name</span><span class="p">:</span> <span class="n">A</span> <span class="n">numerical</span> <span class="n">question</span>

        <span class="n">statement</span><span class="p">:</span> <span class="n">What</span> <span class="ow">is</span><span class="o">...</span>

        <span class="n">feedback</span><span class="p">:</span> <span class="n">Well</span><span class="o">...</span>

        <span class="n">parameters</span><span class="p">:</span>

          <span class="o">-</span> <span class="n">a</span><span class="p">:</span> <span class="mi">5</span>
            <span class="n">b</span><span class="p">:</span> <span class="mi">3</span>

      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">A</span>

        <span class="n">question</span> <span class="n">base</span> <span class="n">name</span><span class="p">:</span> <span class="n">Another</span> <span class="n">numerical</span> <span class="n">question</span>

        <span class="n">statement</span><span class="p">:</span> <span class="n">What</span> <span class="ow">is</span><span class="o">...</span>

        <span class="n">feedback</span><span class="p">:</span> <span class="n">Well</span><span class="o">...</span>
        
        <span class="n">number</span> <span class="n">of</span> <span class="n">instances</span><span class="p">:</span> <span class="mi">2</span>

  <span class="c1"># -----------------------------</span>

  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Category</span> <span class="mi">2</span>

    <span class="n">classes</span><span class="p">:</span>

      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">B</span>

        <span class="n">question</span> <span class="n">base</span> <span class="n">name</span><span class="p">:</span> <span class="n">A</span> <span class="n">multiple</span><span class="o">-</span><span class="n">choice</span> <span class="n">question</span>

        <span class="n">init</span> <span class="n">parameters</span><span class="p">:</span>

          <span class="n">nodes</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">]</span>

        <span class="n">statement</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">Consider</span><span class="o">...</span>

        <span class="n">feedback</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">We</span> <span class="n">must</span><span class="o">...</span>

        <span class="n">parameters</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">dijkstra_parameters</span>

          <span class="o">-</span> <span class="n">n</span><span class="p">:</span> <span class="mi">0</span>

          <span class="o">-</span> <span class="n">n</span><span class="p">:</span> <span class="mi">1</span>
            
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Category</span> <span class="mi">3</span>

    <span class="n">classes</span><span class="p">:</span>

      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">C</span>

        <span class="n">question</span> <span class="n">base</span> <span class="n">name</span><span class="p">:</span> <span class="n">Another</span> <span class="n">numerical</span> <span class="n">question</span>

        <span class="n">statement</span><span class="p">:</span> <span class="n">What</span> <span class="ow">is</span><span class="o">...</span>

        <span class="n">feedback</span><span class="p">:</span> <span class="n">Well</span><span class="o">...</span>
        
        <span class="n">number</span> <span class="n">of</span> <span class="n">instances</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we need to define the classes referenced above (<code>A</code>, <code>B</code> and <code>C</code>)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">NumericalQuestionGenerator</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span>  <span class="s1">&#39;10%&#39;</span>

<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">MultipleChoiceQuestionGenerator</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">statement</span><span class="p">:</span> <span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">TemplatedLatexText</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">TemplatedLatexText</span><span class="p">,</span>
        <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">prng</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="n">feedback</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">prng</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span>
    
    
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">wrong_answers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;nope&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;yessss!!!&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
        <span class="p">]</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">py2gift</span><span class="o">.</span><span class="n">question</span><span class="o">.</span><span class="n">NumericalQuestionGenerator</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="mi">52</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span>  <span class="s1">&#39;10%&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">build_question</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">category_name</span><span class="o">=</span><span class="s1">&#39;Category 1&#39;</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">yaml_to_dict</span><span class="p">(</span><span class="n">settings_file</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">build_question</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">category_name</span><span class="o">=</span><span class="s1">&#39;Category 3&#39;</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">yaml_to_dict</span><span class="p">(</span><span class="n">settings_file</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !rm {settings_file}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Previewing">Previewing<a class="anchor-link" href="#Previewing"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The settings of a question (in the form of a dictionary),</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">question_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;Numerical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;statement&#39;</span><span class="p">:</span> <span class="s1">&#39;What is the value of $</span><span class="se">\\</span><span class="s1">pi$?&#39;</span><span class="p">,</span>
    <span class="s1">&#39;solution&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">3.14</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;50%&#39;</span><span class="p">},</span>
    <span class="s1">&#39;feedback&#39;</span><span class="p">:</span> <span class="s1">&#39;well, $</span><span class="se">\\</span><span class="s1">pi$&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>, can be turned into a markdown string by <code>question.settings_to_markdown</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">render_latex</span><span class="p">(</span><span class="n">py2gift</span><span class="o">.</span><span class="n">markdown</span><span class="o">.</span><span class="n">settings_to_markdown</span><span class="p">(</span><span class="n">question_settings</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generator_to_markdown" class="doc_header"><code>generator_to_markdown</code><a href="https://github.com/manuvazquez/py2gift/tree/master/py2gift/core.py#L212" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generator_to_markdown</code>(<strong><code>settings</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>, <code>dict</code>], <strong><code>category</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Returns markdown text from a generator.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>settings: str, Pathlib, dict
    The settings file or corresponding dictionary.
category: str
    The category of the question.
cls: py2gift.question.QuestionGenerator
    The class implementing the generator.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>out: str
    Markdown text.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">render_latex</span><span class="p">(</span><span class="n">generator_to_markdown</span><span class="p">(</span><span class="n">settings_file</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s1">&#39;Category 1&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">A</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Preprocessing-tex-files">Preprocessing tex files<a class="anchor-link" href="#Preprocessing-tex-files"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Function to turn a $\TeX$ file into an svg. It returns a <em>markdown</em> string that allows to visualize it in a cell.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="latex_to_markdown" class="doc_header"><code>latex_to_markdown</code><a href="https://github.com/manuvazquez/py2gift/tree/master/py2gift/core.py#L248" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>latex_to_markdown</code>(<strong><code>input_file</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>], <strong><code>delete_input_file_afterwards</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Returns markdown text that shows the result of compiling a TeX file.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>input_file: str, Pathlib
    The TeX file.
delete_input_file_afterwards: bool
    If True the TeX file is deleted after conversion to svg.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>out: str
    Markdown text.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tex_file</span> <span class="o">=</span> <span class="s1">&#39;_sample.tex&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%writefile</span> {tex_file}
\<span class="n">documentclass</span><span class="p">[]{</span><span class="n">standalone</span><span class="p">}</span>

\<span class="n">usepackage</span><span class="p">[</span><span class="n">utf8</span><span class="p">]{</span><span class="n">inputenc</span><span class="p">}</span>

\<span class="n">usepackage</span><span class="p">{</span><span class="n">tikz</span><span class="p">}</span>


\<span class="n">begin</span><span class="p">{</span><span class="n">document</span><span class="p">}</span>

\<span class="n">begin</span><span class="p">{</span><span class="n">tikzpicture</span><span class="p">}</span>
    \<span class="n">node</span><span class="p">[</span><span class="n">draw</span><span class="p">,</span> <span class="n">text</span> <span class="n">width</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">center</span><span class="p">,</span><span class="n">font</span><span class="o">=</span>\<span class="n">small</span><span class="p">,</span><span class="n">minimum</span> <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">]</span> <span class="p">{</span><span class="n">The</span> <span class="n">Ingenious</span> <span class="n">Gentleman</span> <span class="n">Don</span> <span class="n">Quixote</span> <span class="n">of</span> <span class="n">La</span> <span class="n">Mancha</span><span class="p">};</span>
\<span class="n">end</span><span class="p">{</span><span class="n">tikzpicture</span><span class="p">}</span>

\<span class="n">end</span><span class="p">{</span><span class="n">document</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">py2gift</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">render_latex</span><span class="p">(</span><span class="n">latex_to_markdown</span><span class="p">(</span><span class="n">tex_file</span><span class="p">,</span> <span class="n">delete_input_file_afterwards</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

